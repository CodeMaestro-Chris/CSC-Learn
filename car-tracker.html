<!DOCTYPE html>
<html>
<head>
  <title>Car Tracking Simulation</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 400px; }
    .controls { margin: 10px; }
    body.light-mode { background: #fff; color: #000; }
    body.dark-mode { background: #222; color: #eee; }
  </style>
</head>
<body class="light-mode">
  <div class="controls">
    <button id="start">Start Tracking</button>
    <button id="stop">Stop Tracking</button>
    <div>Current: <span id="coords">—</span></div>
  </div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // JavaScript goes here (next section)
    // 1. Initialize the map centered around Aba
const map = L.map('map').setView([5.085, 7.382], 13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

// 2. Route coordinates (simulated along road)
const route = [
  [5.07196, 7.39001],
  [5.075, 7.388],
  [5.079, 7.385],
  [5.085, 7.380],
  [5.092, 7.378],
  [5.098, 7.377],
  [5.10194, 7.37583]
];

// 3. Place a custom car icon
const carIcon = L.icon({
  iconUrl: 'img/sport-car.png', // use downloaded icon from flaticon
  iconSize: [32, 32],
  iconAnchor: [16, 16],
});
const marker = L.marker(route[0], { icon: carIcon }).addTo(map);

// 4. Simulated movement
let idx = 0, anim, running = false;
function startTracking() {
  if (running) return;
  running = true;
  const totalTime = 10 * 60 * 1000; // 10 minutes
  const stepDuration = totalTime / (route.length - 1);
  animateStep();
  function animateStep() {
    if (!running || idx >= route.length -1) return;
    anim = setTimeout(() => {
      idx++;
      moveMarker(route[idx]);
      animateStep();
    }, stepDuration);
  }
}
function stopTracking() {
  running = false;
  clearTimeout(anim);
}

// Move marker and update coordinates
function moveMarker([lat, lng]) {
  marker.setLatLng([lat,lng]);
  document.getElementById('coords').innerText = `${lat.toFixed(5)}, ${lng.toFixed(5)}`;
}

// Attach buttons
document.getElementById('start').onclick = startTracking;
document.getElementById('stop').onclick = stopTracking;


const history = JSON.parse(localStorage.getItem('carPath')) || [];
history.push({lat, lng, time: Date.now()});
localStorage.setItem('carPath', JSON.stringify(history));

  </script>
</body>
</html>
